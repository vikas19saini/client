{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\Projects\\\\client\\\\src\\\\components\\\\login.js\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport { Fragment, useState } from \"react\";\nimport axios from \"axios\";\nimport { toast, ToastContainer } from 'react-nextjs-toast';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useRouter } from 'next/router';\nexport default function Login() {\n  const dispatch = useDispatch();\n  const {\n    0: isLoggingIn,\n    1: setIsLoggingIn\n  } = useState(false);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n  const {\n    0: otpSent,\n    1: setOtpSent\n  } = useState(false);\n  const {\n    0: verifyingOtp,\n    1: setVerifyingOtp\n  } = useState(false);\n  const {\n    0: email,\n    1: setEmail\n  } = useState(null);\n  const {\n    0: showLoginPage,\n    1: setShowLoginPage\n  } = useState(true);\n  const router = useRouter();\n  const redirect = router.query.redirect || null;\n  let cart = useSelector(state => state.config.cart ? state.config.cart : []);\n\n  const login = e => {\n    e.preventDefault();\n    setIsLoggingIn(true);\n    axios.post(`${process.env.API_URL}user/login`, {\n      email: e.target.email.value,\n      password: e.target.password.value\n    }).then(res => {\n      setIsLoggingIn(false);\n      dispatch({\n        type: \"USER_LOGIN\",\n        payload: res.data\n      });\n      axios.post(`${process.env.API_URL}cart/sync`, {\n        cartItems: cart\n      }).then(response => {\n        console.log(response.data);\n        dispatch({\n          type: \"ADD_TO_CART\",\n          payload: response.data\n        });\n      });\n      redirect && router.push(redirect);\n    }).catch(err => {\n      setIsLoggingIn(false);\n      toast.notify(err.response.data.message, {\n        type: \"error\",\n        title: \"OTP Error!\"\n      });\n    });\n  };\n\n  const onSubmit = e => {\n    e.preventDefault();\n    let name = e.target.name.value;\n    let email = e.target.email.value;\n    let password = e.target.password.value;\n    let confirmPassword = e.target.confirmPassword.value;\n    let phone = e.target.phone.value;\n    setEmail(email);\n\n    if (confirmPassword !== password) {\n      toast.notify(\"Password and confirm password does not match!\", {\n        type: \"error\",\n        title: \"Error!\"\n      });\n      return false;\n    }\n\n    setIsLoading(true);\n    axios.post(`${process.env.API_URL}customer/registartion`, {\n      name: name,\n      email: email,\n      password: password,\n      phone: phone\n    }).then(response => {\n      toast.notify(\"An OTP sent at your email address!\", {\n        type: \"success\",\n        title: \"OTP Sent!\"\n      });\n      setOtpSent(true);\n    }).catch(err => {\n      let message = err.response.data.errors ? err.response.data.errors[0].message : \"Oops! something went wrong!\";\n      toast.notify(message, {\n        type: \"error\",\n        title: \"OTP Error!\"\n      });\n      setIsLoading(false);\n    });\n  };\n\n  const verifyOtp = e => {\n    e.preventDefault();\n    setVerifyingOtp(true);\n    axios.post(`${process.env.API_URL}customer/verify`, {\n      otp: e.target.otp.value,\n      email: email\n    }).then(res => {\n      setVerifyingOtp(false);\n      toast.notify(\"OTP Verified! Please login\", {\n        type: \"success\",\n        title: \"OTP!\"\n      });\n      setShowLoginPage(true);\n    }).catch(err => {\n      toast.notify(err.response.data.message, {\n        type: \"error\",\n        title: \"OTP Error!\"\n      });\n      setVerifyingOtp(false);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Login - Gandhi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this), showLoginPage ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid ld_bg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inner_main_ld\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/images/logo.png\",\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Personalize your style from the fabric\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n            children: \"Welcome to Gandhi Fabric\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: login,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form_login\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"email\",\n                name: \"email\",\n                placeholder: \"Email Address\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"password\",\n                name: \"password\",\n                placeholder: \"Password\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 45\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"login_bttn go_bttn\",\n              disabled: isLoggingIn,\n              children: isLoggingIn ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loader\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 61\n              }, this) : \"LOGIN\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mass_tx\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                href: \"#registartion\",\n                onClick: () => setShowLoginPage(false),\n                children: \"Doesn\\u2019t have an account? Signup\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 45\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 25\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid ld_bg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inner_main_ld\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/images/logo.png\",\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            style: {\n              textAlign: \"center\"\n            },\n            children: \"Personalize your style from the fabric\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n            children: \"Welcome to Gandhi Fabric\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 37\n          }, this), !otpSent ? /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: onSubmit,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form_login\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"name\",\n                placeholder: \"Name\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                name: \"phone\",\n                placeholder: \"Mobile number\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                name: \"email\",\n                placeholder: \"Email address\",\n                type: \"email\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"password\",\n                name: \"password\",\n                placeholder: \"Password\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"password\",\n                name: \"confirmPassword\",\n                placeholder: \"Confirm assword\",\n                required: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 53\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 49\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"login_bttn go_bttn\",\n              disabled: isLoading,\n              children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loader\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 66\n              }, this) : \"SIGNUP\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 49\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mass_tx\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                href: \"#login\",\n                onClick: () => setShowLoginPage(true),\n                children: \"Already have an account? Login\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 49\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 45\n          }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: verifyOtp,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form_login\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  name: \"otp\",\n                  \"aria-label\": \"Otp\",\n                  placeholder: \"OTP\",\n                  type: \"text\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 61\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 57\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 53\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"login_bttn go_bttn\",\n              disabled: verifyingOtp,\n              children: verifyingOtp ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loader\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 73\n              }, this) : \"VERIFY\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 53\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mass_tx\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                href: \"#login\",\n                onClick: () => setShowLoginPage(true),\n                children: \"Already have an account? Login\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 57\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 53\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 49\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 25\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 9\n  }, this);\n}","map":{"version":3,"sources":["D:/Projects/client/src/components/login.js"],"names":["Head","Link","Fragment","useState","axios","toast","ToastContainer","useDispatch","useSelector","useRouter","Login","dispatch","isLoggingIn","setIsLoggingIn","isLoading","setIsLoading","otpSent","setOtpSent","verifyingOtp","setVerifyingOtp","email","setEmail","showLoginPage","setShowLoginPage","router","redirect","query","cart","state","config","login","e","preventDefault","post","process","env","API_URL","target","value","password","then","res","type","payload","data","cartItems","response","console","log","push","catch","err","notify","message","title","onSubmit","name","confirmPassword","phone","errors","verifyOtp","otp","textAlign"],"mappings":"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","sourcesContent":["import Head from \"next/head\";\r\nimport Link from \"next/link\";\r\nimport { Fragment, useState } from \"react\";\r\nimport axios from \"axios\"\r\nimport { toast, ToastContainer } from 'react-nextjs-toast'\r\nimport { useDispatch, useSelector } from \"react-redux\"\r\nimport { useRouter } from 'next/router'\r\n\r\nexport default function Login() {\r\n    const dispatch = useDispatch()\r\n    const [isLoggingIn, setIsLoggingIn] = useState(false)\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const [otpSent, setOtpSent] = useState(false)\r\n    const [verifyingOtp, setVerifyingOtp] = useState(false)\r\n    const [email, setEmail] = useState(null)\r\n    const [showLoginPage, setShowLoginPage] = useState(true)\r\n    const router = useRouter()\r\n    const redirect = router.query.redirect || null;\r\n    let cart = useSelector(state => state.config.cart ? state.config.cart : []);\r\n\r\n    const login = (e) => {\r\n        e.preventDefault()\r\n        setIsLoggingIn(true)\r\n\r\n        axios.post(`${process.env.API_URL}user/login`, { email: e.target.email.value, password: e.target.password.value }).then(res => {\r\n            setIsLoggingIn(false)\r\n            dispatch({ type: \"USER_LOGIN\", payload: res.data });\r\n            axios.post(`${process.env.API_URL}cart/sync`, { cartItems: cart }).then((response) => {\r\n                console.log(response.data);\r\n                dispatch({ type: \"ADD_TO_CART\", payload: response.data });\r\n            })\r\n            redirect && router.push(redirect)\r\n        }).catch(err => {\r\n            setIsLoggingIn(false)\r\n            toast.notify(err.response.data.message, {\r\n                type: \"error\",\r\n                title: \"OTP Error!\"\r\n            })\r\n        })\r\n    }\r\n\r\n    const onSubmit = (e) => {\r\n        e.preventDefault()\r\n        let name = e.target.name.value\r\n        let email = e.target.email.value\r\n        let password = e.target.password.value\r\n        let confirmPassword = e.target.confirmPassword.value\r\n        let phone = e.target.phone.value\r\n\r\n        setEmail(email)\r\n\r\n        if (confirmPassword !== password) {\r\n            toast.notify(\"Password and confirm password does not match!\", {\r\n                type: \"error\",\r\n                title: \"Error!\"\r\n            })\r\n            return false\r\n        }\r\n\r\n        setIsLoading(true)\r\n        axios.post(`${process.env.API_URL}customer/registartion`, {\r\n            name: name,\r\n            email: email,\r\n            password: password,\r\n            phone: phone\r\n        }).then((response) => {\r\n            toast.notify(\"An OTP sent at your email address!\", {\r\n                type: \"success\",\r\n                title: \"OTP Sent!\"\r\n            })\r\n            setOtpSent(true)\r\n        }).catch(err => {\r\n            let message = err.response.data.errors ? err.response.data.errors[0].message : \"Oops! something went wrong!\"\r\n            toast.notify(message, {\r\n                type: \"error\",\r\n                title: \"OTP Error!\"\r\n            })\r\n\r\n            setIsLoading(false)\r\n        })\r\n\r\n    }\r\n\r\n    const verifyOtp = (e) => {\r\n        e.preventDefault()\r\n\r\n        setVerifyingOtp(true)\r\n        axios.post(`${process.env.API_URL}customer/verify`, { otp: e.target.otp.value, email: email }).then(res => {\r\n            setVerifyingOtp(false)\r\n            toast.notify(\"OTP Verified! Please login\", {\r\n                type: \"success\",\r\n                title: \"OTP!\"\r\n            })\r\n            setShowLoginPage(true)\r\n        }).catch(err => {\r\n            toast.notify(err.response.data.message, {\r\n                type: \"error\",\r\n                title: \"OTP Error!\"\r\n            })\r\n            setVerifyingOtp(false)\r\n        })\r\n    }\r\n\r\n    return (\r\n        <Fragment>\r\n            <Head>\r\n                <title>Login - Gandhi</title>\r\n            </Head>\r\n            <ToastContainer />\r\n            {\r\n                showLoginPage ?\r\n                    (\r\n                        <div className=\"container-fluid ld_bg\">\r\n                            <div className=\"row\">\r\n                                <div className=\"inner_main_ld\">\r\n                                    <img src=\"/images/logo.png\" alt=\"\" />\r\n                                    <h4>Personalize your style from the fabric</h4>\r\n                                    <h6>Welcome to Gandhi Fabric</h6>\r\n                                    <form onSubmit={login}>\r\n                                        <div className=\"form_login\">\r\n                                            <input type=\"email\" name=\"email\" placeholder=\"Email Address\" required={true} />\r\n                                            <input type=\"password\" name=\"password\" placeholder=\"Password\" required={true} />\r\n                                            {/* <div className=\"reset_pass\"><a href=\"#\">Forgot Password?</a></div> */}\r\n                                        </div>\r\n                                        <button type=\"submit\" className=\"login_bttn go_bttn\" disabled={isLoggingIn}>\r\n                                            {isLoggingIn ? (<div className=\"loader\"></div>) : \"LOGIN\"}\r\n                                        </button>\r\n                                        <p className=\"mass_tx\">\r\n                                            <a href=\"#registartion\" onClick={() => setShowLoginPage(false)}>Doesn’t have an account? Signup</a>\r\n                                        </p>\r\n                                    </form>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"container-fluid ld_bg\">\r\n                            <div className=\"row\">\r\n                                <div className=\"inner_main_ld\">\r\n                                    <img src=\"/images/logo.png\" alt=\"\" />\r\n                                    <h4 style={{textAlign: \"center\"}}>Personalize your style from the fabric</h4>\r\n                                    <h6>Welcome to Gandhi Fabric</h6>\r\n                                    {\r\n                                        !otpSent ? (\r\n                                            <form onSubmit={onSubmit} >\r\n                                                <div className=\"form_login\">\r\n                                                    <input type=\"text\" name=\"name\" placeholder=\"Name\" required />\r\n                                                    <input type=\"text\" name=\"phone\" placeholder=\"Mobile number\" required />\r\n                                                    <input name=\"email\" placeholder=\"Email address\" type=\"email\" required />\r\n                                                    <input type=\"password\" name=\"password\" placeholder=\"Password\" required />\r\n                                                    <input type=\"password\" name=\"confirmPassword\" placeholder=\"Confirm assword\" required />\r\n                                                </div>\r\n                                                <button type=\"submit\" className=\"login_bttn go_bttn\" disabled={isLoading}>{\r\n                                                    isLoading ? (<div className=\"loader\"></div>) : \"SIGNUP\"\r\n                                                }</button>\r\n                                                <p className=\"mass_tx\">\r\n                                                    <a href=\"#login\" onClick={() => setShowLoginPage(true)}>Already have an account? Login</a>\r\n                                                </p>\r\n                                            </form>\r\n                                        ) : (\r\n                                                <form onSubmit={verifyOtp}>\r\n                                                    <div className=\"form_login\">\r\n                                                        <div>\r\n                                                            <input name=\"otp\" aria-label=\"Otp\" placeholder=\"OTP\" type=\"text\" required />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <button type=\"submit\" className=\"login_bttn go_bttn\" disabled={verifyingOtp}>{\r\n                                                        verifyingOtp ? (<div className=\"loader\"></div>) : \"VERIFY\"\r\n                                                    }</button>\r\n                                                    <p className=\"mass_tx\">\r\n                                                        <a href=\"#login\" onClick={() => setShowLoginPage(true)}>Already have an account? Login</a>\r\n                                                    </p>\r\n                                                </form>\r\n                                            )\r\n                                    }\r\n\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )\r\n            }\r\n\r\n        </Fragment>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}